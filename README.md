# ChillPill Firmware (STM32F103, CubeIDE)

Layered firmware for the ChillPill machine using STM32 HAL.

## Layout
- **Core/Inc, Core/Src**: app code
  - Foundation Files: `flash_params`, `stm32f1xx_hal_msp`, `stm32f1xx_it`, `syscalls`, `sysmem`, `system_stm32f1xx`
  - Core Files: `actuators`, `sensors`, `lights`, `buttons`, `irq_handler_callback`, `user_settings`, `main`
  - Control FSM Files: `finite_state_machine`, `pid_controller`, `fault_handler`, `factory_test`, `estimator`
  - Config: `control_config`
- **Drivers/**: CMSIS + STM32F1xx HAL driver (vendor code, committed)
- **Startup/**: startup assembly and linker/startup bits (as generated by CubeIDE)

## Build
Open in **STM32CubeIDE** (File → Open Projects from File System…) and build.
Toolchain: GCC for ARM (CubeIDE default).

## Init order (high level)
HAL & clocks → MSP/IT → `sensors_init`, `actuators_init`, `lights_init`, `buttons_init`, `user_settings_init` → `estimator_init`, `pid_init`, `fsm_init`.

## Notes
- No secrets in repo. If needed, create `private_config.h` (ignored) and commit `private_config.h.example`.
